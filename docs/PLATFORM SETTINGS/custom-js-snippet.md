---
title: Custom JS snippet
excerpt: >-
  Admin users may override certain behaviors of the Recurly Engage JavaScript
  SDK by supplying custom `fetchUserId` and `fetchAnonUserId` functions.
deprecated: false
hidden: false
metadata:
  title: ''
  description: ''
  robots: index
next:
  description: ''
---
# Overview

### Required plan

This feature or setting is available to all customers on any Recurly Engage subscription plan.

export const PrerequisitesLimitations = ({ header }) => {
  return (
    <div className="flex justify-start">
      <div className="rounded-md p-6 m-4 max-w-lg shadow-md border border-gray-300 dark:bg-gray-800 dark:border-gray-600">
        <p className="text-lg font-bold">{header}</p>
        <p>
          <i className="fa-solid fa-check mr-2" />
          You must have <strong>Company</strong> or <strong>App Administrator</strong> permissions in Recurly Engage.
        </p>
        <p>
          <i className="fa-solid fa-exclamation-triangle mr-4" />
          Familiarity with your site’s user identification (<code>localStorage</code>, <code>cookies</code>, <code>dataLayer</code>).
        </p>
      </div>
    </div>
  );
};

<PrerequisitesLimitations header="Prerequisites & limitations" />

# Definition

The **Custom JS Snippet** feature lets you override the default user‐identification logic in the Recurly Engage JavaScript SDK by providing your own implementations of:

* `fetchUserId()` (required): returns the authenticated user’s ID.
* `fetchAnonUserId()` (optional): returns the anonymous user’s ID if your app generates one.

# Key benefits

* **Accurate user matching**: Tie prompts and 1-click actions to your existing user IDs.
* **Seamless integration**: Use any client-side storage (cookies, local/sessionStorage, dataLayer).
* **Enhanced reporting**: Ensure downstream analytics and connector actions receive the correct user identifiers.

# Key details

Admin users may override certain behaviors of the Recurly Engage JavaScript SDK. Upon deploying Recurly Engage for the first time, it is important to review and configure the following functions to ensure that users are recognized using your unique identifiers. These identifiers will be utilized for 1-click actions as well as downstream reporting.

You may need to work with your developers to determine the best method to identify users. The most common methods to retrieve a User ID are:

* localStorage or sessionStorage item
* browser cookie
* accessing an item stored in the browser’s dataLayer

Reach out to Recurly Engage Support if you need assistance.

## FetchUserID (required)

This function is invoked to determine a user’s authenticated User ID when the Recurly Engage JS tag is loaded.

```javascript
static fetchUserId() {
  if( localStorage.getItem("ajs_user_id" )
    return JSON.parse(localStorage.getItem("ajs_user_id"));
  return null;
}
```

## FetchAnonymousUserID (optional)

This function is invoked to determine a user’s anonymous User ID (if generated by your web app). If your web app does not generate an anonymous User ID, Recurly Engage will automatically assign one to unauthenticated users.

```javascript
static fetchAnonUserId() {
  if( localStorage.getItem("ajs_anonymous_id" )
    return JSON.parse(localStorage.getItem("ajs_anonymous_id"));
  return null;
}
```